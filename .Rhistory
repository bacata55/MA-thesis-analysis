labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg)) +
geom_smooth(method = "loess")
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg)) +
geom_smooth(method = "loess")
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg)) +
geom_smooth(method = "loess") +
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess") +
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE, span = 0.9) +
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE, span = 0.75) +
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE, span = 0.5) +
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE) +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
negs <- cbind(FARC_results$neg, joint_results$neg, govt_results$neg)
negs <- rbind(FARC_results$neg, joint_results$neg, govt_results$neg)
negs <- data.frame(rbind(FARC_results$neg, joint_results$neg, govt_results$neg))
negs <- data.frame(cbind(FARC_results$neg, joint_results$neg, govt_results$neg))
govt_lines[[1]]
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
stat_function(fun = govt_lines[[1]], color = "Joint statement") +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
stat_function(fun = govt_lines[[1]], color = "Joint statement") +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
stat_function(fun = govt_lines[[1]], color = "Joint statement") +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
class(govt_lines[[1]])
fneg <- select(FARC_results, neg)
fneg <- dplyr::select(FARC_results, date, neg)
fneg
gneg <- dplyr::select(govt_results, date, neg)
jneg <- dplyr::select(joint_results, date, neg)
all_neg <- cbind(fneg, gneg, jneg)
all_neg <- rbind(fneg, gneg, jneg)
all_neg
colnames(fneg)[2] <- "f"
fneg <- dplyr::select(FARC_results, date, neg)
colnames(fneg)[2] <- "f"
gneg <- dplyr::select(govt_results, date, neg)
colnames(gneg)[2] <- "g"
jneg <- dplyr::select(joint_results, date, neg)
colnames(jneg)[2] <- "j"
all_neg <- rbind(fneg, gneg, jneg)
all_neg <- cbind(fneg, gneg, jneg)
FARC_results$group <- "F"
govt_results$group <- "G"
joint_results$group <- "J"
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
geom_smooth(method = "loess", data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
base_neg = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Neg Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_neg
neg_major
base_pos = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pos, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pos, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pos, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Pos Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_pos
base_grapher <- function(sentiment_measure) {
ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = neg, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Sentiment",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
}
base_grapher(pp3)
FARC_results$pp3
base_pos = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pos, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pos, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pos, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pos, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pos, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Pos Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
}
base_pos
base_grapher <- function(sentiment_measure) {
ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Sentiment",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
}
base_grapher(neg)
base_grapher(pos)
base_grapher("neg")
base_grapher("pp3")
base_grapher <- function(sentiment_measure) {
sentiment_measure <- deparse(sentiment_measure)
ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Sentiment",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
}
base_grapher(neg)
base_grapher <- function(sentiment_measure) {
sentiment_measure <- deparse(substitute(sentiment_measure))
ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Sentiment",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
}
base_grapher <- function(sentiment_measure) {
sentiment_measure <- deparse(substitute(sentiment_measure))
ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Sentiment",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
}
base_grapher(neg)
base_grapher <- function(sentiment_measure) {
ggraph <- ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Sentiment",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
return(ggraph)
}
base_grapher(neg)
foo <- function(x) {
return(FARC_results$x)
}
foo(neg)
foo <- function(column) {
x <- FARC_results$column
return(x)
}
foo(neg)
base_grapher <- function(sentiment_measure) {
sentiment_measure <- "sentiment_measure"
ggraph <- ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Sentiment",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
return(ggraph)
}
base_grapher(neg)
base_grapher <- function(sentiment_measure) {
sentiment_measure <- deparse(substitute(sentiment_measure))
ggraph <- ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = sentiment_measure, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Sentiment",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
return(ggraph)
}
base_grapher(neg)
foo <- function(column) {
return(FARC_results$"column")
}
foo(neg)
foo <- function(column) {
x <- deparse(substitute(column))
return(FARC_results$x)
}
foo(neg)
base_ellos = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Pos Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
base_ellos
# Neg emotion and major agreements/violence
neg_major <- base_neg +
ggtitle("Major Events and Percent Negative Emotion Words in Statements") +
geom_vline(data = filter(dates, group == "major_agree"), mapping = aes(xintercept = as.numeric(date), color = "Major agreement"), linetype = 2) +
geom_vline(data = filter(dates, group == "major_viol"), mapping = aes(xintercept = as.numeric(date), color = "Major violence"), linetype = 1)
# Neg emotion and ceasefire dates
neg_cf <- base_neg +
ggtitle("Ceasefires and Percent Negative Emotion Words in Statements") +
geom_rect(aes(xmin=cf_start[1], xmax=cf_end[1], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3) +
geom_rect(aes(xmin=cf_start[2], xmax=cf_end[2], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3) +
geom_rect(aes(xmin=cf_start[3], xmax=cf_end[3], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3) +
geom_rect(aes(xmin=cf_start[4], xmax=cf_end[4], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3) +
geom_rect(aes(xmin=cf_start[5], xmax=cf_end[5], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3)
# pos emotion and major agreements
pos_major <- base_pos +
ggtitle("Major Events and Percent Positive Emotion Words in Statements") +
geom_vline(data = filter(dates, group == "major_agree"), mapping = aes(xintercept = as.numeric(date), color = "Major agreement"), linetype = 2) +
geom_vline(data = filter(dates, group == "major_viol"), mapping = aes(xintercept = as.numeric(date), color = "Major violence"), linetype = 1)
# pos emotion and ceasefires
pos_cf <- base_pos +
ggtitle("Ceasefires and Percent Positive Emotion Words in Statements") +
geom_rect(aes(xmin=cf_start[1], xmax=cf_end[1], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3) +
geom_rect(aes(xmin=cf_start[2], xmax=cf_end[2], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3) +
geom_rect(aes(xmin=cf_start[3], xmax=cf_end[3], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3) +
geom_rect(aes(xmin=cf_start[4], xmax=cf_end[4], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3) +
geom_rect(aes(xmin=cf_start[5], xmax=cf_end[5], ymin=-Inf, ymax=Inf), fill = "yellow", linetype = 0, alpha = 0.3)
#################################################################################
# let's graph 3rd person plural pronouns from FARC -- indicator of extremism
base_ellos = ggplot(FARC_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "FARC statement")) +
geom_smooth(method = "loess", se = FALSE) +
geom_jitter() +
geom_point(data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "Joint statement")) +
geom_smooth(method = "loess", se = FALSE, data = joint_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "Joint statement")) +
geom_point(data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "Govt statement")) +
geom_smooth(method = "loess", se = FALSE, data = govt_results, aes(x = as.Date(date, origin = "1970-01-01"), y = pp3, color = "Govt statement")) +
labs(
x = "Date",
y = "Percent Pos Emotion",
color = "Legend") +
scale_x_date(date_minor_breaks = "1 month",
limits = c(as.Date("2012-06-01", "%Y-%m-%d"), NA))
# add major agreements and ceasefires
ellos_major <- base_ellos +
ggtitle("Major Events and Use of 3rd Person Pl. Pronoun") +
geom_vline(data = filter(dates, group == "major_agree"), mapping = aes(xintercept = as.numeric(date), color = "Major agreement"), linetype = 2) +
geom_vline(data = filter(dates, group == "major_viol"), mapping = aes(xintercept = as.numeric(date), color = "Major violence"), linetype = 1)
# Function to find breakpoints for each column of a dataframe. Takes one argument: a dataframe whose first column is the date
break_finder <- function(df) {
# make a list to contain the dates
break_obs <- vector("list", length(df) - 1)
# get breakpoints
for (i in 2:length(df)) {
break_obs[i - 1] <- (list(breakpoints(df[[i]] ~ 1)$breakpoints))
}
return(break_obs)
}
# Function to convert break obs to dates. Takes two arguments: a list of lists (shudder), and an original df
get_breakdate <- function(listoflists, df) {
# for each list of break obs
for (i in 1:length(listoflists)) {
# if it's not empty
if (!is.na(listoflists[i])) {
# get the observations
unlisted_obs <- unlist(listoflists[i])
dates_list <- vector("list", 0)
# and then for each of the observations
for (j in 1:length(unlisted_obs)) {
# get the date from the dataframe and add it to the list
current_date <- df$date[unlisted_obs[j]]
dates_list <- append(dates_list, current_date)
}
listoflists[i] <- list(dates_list)
}
}
return(listoflists)
}
FARC_breaks <- get_breakdate(break_finder(FARC_results), FARC_results)
govt_breaks <- get_breakdate(break_finder(govt_results), govt_results)
joint_breaks <- get_breakdate(break_finder(joint_results), joint_results)
FARC_breaks <- get_breakdate(break_finder(FARC_results), FARC_results)
break_finder(FARC_results), FARC_results
break_finder(FARC_results)
